\chapter{Security and User Privacy Vulnerabilities of Instant Messaging System}
\label{ch:security-and-user-privacy-vulnerabilities-of-instant-messaging-system}

%Nowadays, the instant messaging systems became the most widely-used and convenient way of communication between
%people via internet.
%These systems offer a simple and inexpensive way to continuance existing relationships and forming new by providing an
%attractive means for sharing information and digital social interactions.
%The quick development of instant messaging systems and the widening of their popularity sometimes moves the
%focus from possible security risks.
%In the worst case, instant messaging system exposes vulnerable to security and privacy channels to hackers and intruders
%[\cite{mcclure2009hacking, mannan2005secure}].
%In existing instant messaging systems, there are multiple privacy and security issues that need to be resolved in order
%to protect user's confidential information and shared data via these messaging applications [\cite{loesing2006privacy}].
%The source [\cite{job2015modified}] gives an analysis of Telegram Messenger and the related MTProto Protocol with cryptography
%behind the popular messenger Telegram.
%Meanwhile, the researchers in [\cite{khan2015survey}] discussed types of threats on privacy of instant messaging systems
%and ranges of thereat effects for both, user and provider.
%There are numerous risks associated with the use of instant messaging applications and as with any form of
%electronic communication one must take certain steps to mitigate those risks.
%In this section we analyze security and user privacy vulnerabilities of instant messaging from the prospective of three
%actors: server, communication channel, end-user.


%\section{Server related vulnerabilities}\label{sec:server-vulnerabilities}
%\input{Sections/server-related-vulnerabilities.tex}
%
%
%\section{Communication channel related vulnerabilities}\label{sec:communication-channel-vulnerabilities}
%\input{Sections/communication-channel-related-vulnerabilities.tex}


%\section{Traits of a secure instant messenger}\label{sec:traits-of-a-secure-instant-messenger}
%\input{Sections/traits-of-a-secure-instant-messenger.tex}
%
%
%\section{User responsibilities}\label{sec:user-responsibilities}
%\input{Sections/user-responsibilities.tex}

\begin{figure}[H]
    \centering
    \includegraphics[width=1.2\textwidth]{Pictures/Threat_Modeling}
    \caption{Database diagram.}\label{fig:figure6}
\end{figure}

\begin{itemize}
    \item \textbf{Web App Request}
    \begin{itemize}
        \item An adversary may gain unauthorized access to Web API due to poor access control checks.
        \item An adversary can gain access to sensitive information from an API through error messages.
        \item An adversary can gain access to sensitive data by sniffing traffic to Web API.
        \item An adversary can gain access to sensitive data stored in Web API's config files.
        \item Attacker can deny a malicious act on an API leading to repudiation issues.
        \item An adversary may spoof Mango Web Application and gain access to Web API.
        \item An adversary may inject malicious inputs into an API and affect downstream processes.
        \item An adversary can gain access to sensitive data by performing SQL injection through Web API\@.
    \end{itemize}
    \item \textbf{Web API Response}
    \begin{itemize}
        \item An adversary can reverse weakly encrypted or hashed content.
        \item An adversary may gain access to sensitive data from log files.
        \item An adversary can gain access to sensitive information through error messages.
        \item Attacker can deny the malicious act and remove the attack foot prints leading to repudiation issues.
        \item An adversary can spoof the target web application due to insecure TLS certificate configuration.
        \item An adversary can steal sensitive data like user credentials.
        \item An adversary can create a fake website and launch phishing attacks.
    \end{itemize}
    \item \textbf{CRUD Request}
    \begin{itemize}
        \item An adversary can gain unauthorized access to database due to loose authorization rules.
        \item An adversary can gain access to sensitive PII or HBI data in database.
        \item An adversary can gain access to sensitive data by performing SQL injection.
        \item An adversary can deny actions on database due to lack of auditing.
        \item An adversary can tamper critical database securables and deny the action.
        \item An adversary may leverage the lack of monitoring systems and trigger anomalous traffic to database.
        \item An adversary can gain unauthorized access to database due to lack of network access protection.
    \end{itemize}
    \item \textbf{Browser UI Update}
    \begin{itemize}
        \item An adversary can perform action on behalf of other user due to lack of controls against cross domain requests.
        \item An adversary may bypass critical steps or perform actions on behalf of other users (victims) due to improper validation logic.
        \item An adversary can reverse weakly encrypted or hashed content.
        \item An adversary may gain access to sensitive data from log files.
        \item An adversary can spoof the target web application due to insecure TLS certificate configuration.
        \item An adversary can steal sensitive data like user credentials.
        \item An adversary can gain access to sensitive data stored in Web App's config files.
        \item An adversary can gain access to sensitive data by performing SQL injection through Web App.
        \item An attacker steals messages off the network and replays them in order to steal a user's session.
        \item An adversary can deface the target web application by injecting malicious code or uploading dangerous files.
        \item An adversary may spoof Desktop Web Browser (Chrome) and gain access to Web Application.
        \item An adversary can create a fake website and launch phishing attacks.
        \item Attackers can steal user session cookies due to insecure cookie attributes.
        \item An adversary can get access to a user's session due to insecure coding practices.
        \item An adversary can get access to a user's session due to improper logout and timeout.
        \item Attacker can deny the malicious act and remove the attack foot prints leading to repudiation issues.
        \item An adversary may gain access to sensitive data from uncleared browser cache.
        \item An adversary can gain access to sensitive information through error messages.
        \item An adversary can gain access to sensitive data by sniffing traffic to Web Application.
        \item An adversary can gain access to certain pages or the site as a whole.
        \item An adversary may gain access to unmasked sensitive data such as credit card numbers.
    \end{itemize}
    \item \textbf{Mobile UI Update}
    \begin{itemize}
        \item An adversary can gain access to sensitive data by performing SQL injection through Web API.
        \item An adversary can reverse engineer and tamper binaries.
        \item An adversary may inject malicious inputs into an API and affect downstream processes.
        \item An adversary may spoof Mobile App (IOS, Android) and gain access to Web API\@.
        \item An adversary obtains refresh or access tokens from Mobile App (IOS, Android) and uses them to
        obtain access to the Mango Web API\@.
        \item Attacker can deny a malicious act on an API leading to repudiation issues.
        \item An adversary can gain access to sensitive data stored in Web API's config files.
        \item An adversary can gain sensitive data from mobile device.
        \item An adversary can gain access to sensitive data by sniffing traffic to Web API\@.
        \item An adversary can gain access to sensitive data by sniffing traffic from Mobile client.
        \item An adversary can gain access to sensitive information from an API through error messages.
        \item An adversary may gain unauthorized access to Web API due to poor access control checks.
        \item An adversary may jail break into a mobile device and gain elevated privilege.
    \end{itemize}
\end{itemize}